[
  {"file_path": "cogs/ticket_handler.py", "content": "import discord\nfrom discord.ext import commands\nimport logging\nimport asyncio\nimport traceback\nfrom datetime import datetime, timezone\nimport time\nimport json\nfrom typing import Optional\nimport re\n\n# –õ–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à –¥–ª—è Steam URL (fallback –¥–ª—è replit DB)\nlocal_steam_cache = {}\n\nfrom cogs.ai import ask_groq\nfrom config import config\nfrom utils.discord_logger import log_error, discord_logger\nfrom utils.logger import get_module_logger\n\nlogger = get_module_logger(__name__)\nfrom handlers.novichok import (\n    get_account_age_days,\n    extract_steam_links,\n    extract_steam_links_from_embed,\n    check_steam_profile_and_nickname,\n    extract_steam_id_from_url,\n)\nfrom utils.validators import is_nickname_format_valid, extract_discord_id\nfrom handlers.novichok_actions import TicketActionView\nfrom utils.rate_limiter import safe_send_message\nfrom utils.ai_moderation import decide_nickname\nfrom utils.misc import extract_real_name_from_discord_nick\n\nlogger = get_module_logger(__name__)\n\n# –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –∑–∞—è–≤–æ–∫: channel_id -> user_id\n\ndef build_nick_reject_embed(member, full, reasons, fixed_full):\n    \"\"\"–°–æ–∑–¥–∞—ë—Ç embed –¥–ª—è –æ—Ç–∫–ª–æ–Ω—ë–Ω–Ω–æ–≥–æ –Ω–∏–∫–Ω–µ–π–º–∞\"\"\"\n    e = discord.Embed(\n        title=\"‚ùå –ù–∏–∫–Ω–µ–π–º –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞–º\",\n        description=f\"–¢–µ–∫—É—â–∏–π: **{discord.utils.escape_markdown(full)}**\",\n        color=0xFF4D4F,\n    )\n    if reasons:\n        e.add_field(name=\"–ü—Ä–∏—á–∏–Ω—ã\", value=\"\\n\".join(f\"‚Ä¢ {r}\" for r in reasons), inline=False)\n    if fixed_full:\n        e.add_field(name=\"–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ\", value=f\"`{fixed_full}`\", inline=False)\n        e.set_footer(text=\"–ù–∞–∂–º–∏—Ç–µ ¬´–ò—Å–ø—Ä–∞–≤—å –º–æ–π SteamNick | –ò–º—è¬ª, —á—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏ –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏—Ç—å.\")\n    else:\n        e.set_footer(text=\"–ò—Å–ø—Ä–∞–≤—å—Ç–µ –Ω–∏–∫ –≤—Ä—É—á–Ω—É—é –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞—è–≤–∫—É –µ—â—ë —Ä–∞–∑¬ª.\")\n    return e\n\n\ndef build_nick_ok_embed(full):\n    \"\"\"–°–æ–∑–¥–∞—ë—Ç embed –¥–ª—è –æ–¥–æ–±—Ä–µ–Ω–Ω–æ–≥–æ –Ω–∏–∫–Ω–µ–π–º–∞\"\"\"\n    return discord.Embed(\n        title=\"‚úÖ –ù–∏–∫–Ω–µ–π–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞–º\",\n        description=f\"–¢–µ–∫—É—â–∏–π: **{discord.utils.escape_markdown(full)}**\",\n        color=0x52C41A,\n    )\n\n\nclass NicknameMismatchModal(discord.ui.Modal):\n    \"\"\"–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö –Ω–∏–∫–Ω–µ–π–º–æ–≤\"\"\"\n\n    def __init__(self, user_id: int, steam_nick: str, real_name: str, source_message_id: int = None, channel_id: int = None):\n        super().__init__(title=\"–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∏–∫–Ω–µ–π–º–∞\", timeout=None)\n        self.user_id = user_id\n        self.steam_nick = steam_nick\n        self.real_name = real_name\n        self.source_message_id = source_message_id\n        self.channel_id = channel_id\n\n    nickname_input = discord.ui.TextInput(\n        label=\"SteamNick | –ò–º—è\",\n        style=discord.TextStyle.short,\n        max_length=32,\n        placeholder=\"–ù–∞–ø—Ä–∏–º–µ—Ä: Terminator | –í–æ–ª–æ–¥—è\",\n        required=True\n    )\n\n    async def on_submit(self, interaction: discord.Interaction):\n        new_nick = self.nickname_input.value.strip()\n\n        try:\n            await interaction.response.defer(ephemeral=False)\n\n            member = interaction.guild.get_member(self.user_id)\n            if not member:\n                await interaction.followup.send(\"‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.\", ephemeral=True)\n                return\n\n            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –Ω–∏–∫–∞\n            if ' | ' not in new_nick:\n                await interaction.followup.send(\n                    \"‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: `SteamNick | –ò–º—è`\\n\"\n                    f\"–ü—Ä–∏–º–µ—Ä: `{self.steam_nick} | {self.real_name}`\",\n                    ephemeral=True\n                )\n                return\n\n            # –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–æ–≤—ã–π –Ω–∏–∫–Ω–µ–π–º\n            old_nick = member.nick or member.display_name\n            await member.edit(nick=new_nick, reason=\"–†—É—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∏–∫–Ω–µ–π–º–∞ –ø—Ä–∏ –ø–æ–¥–∞—á–µ –∑–∞—è–≤–∫–∏\")\n\n            # –°–æ–∑–¥–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è\n            success_message = (\n                f\"‚úÖ **–ù–∏–∫–Ω–µ–π–º –∏–∑–º–µ–Ω—ë–Ω –≤—Ä—É—á–Ω—É—é!**\\n\\n\"\n                f\"üîÑ **–ò–∑–º–µ–Ω–µ–Ω–∏—è:**\\n\"\n                f\"‚Ä¢ –ë—ã–ª–æ: `{old_nick}`\\n\"\n                f\"‚Ä¢ –°—Ç–∞–ª–æ: `{new_nick}`\\n\\n\"\n                f\"üîÑ **–ü—Ä–æ–¥–æ–ª–∂–∞—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞—è–≤–∫–∏...**\"\n            )\n\n            # –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ\n            channel = interaction.client.get_channel(self.channel_id or interaction.channel.id)\n            if self.source_message_id and channel:\n                try:\n                    msg = await channel.fetch_message(self.source_message_id)\n                    await msg.edit(content=success_message, view=None)\n                except discord.NotFound:\n                    await channel.send(success_message)\n            else:\n                await interaction.followup.send(success_message)\n\n            # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞—è–≤–∫–∏\n            await asyncio.sleep(3)\n            bot = interaction.client\n            ticket_handler = bot.get_cog(\"TicketHandler\")\n            if ticket_handler and channel:\n                await ticket_handler.analyze_and_respond_to_application(channel, member)\n\n            logger.info(f\"‚úÖ –ù–∏–∫–Ω–µ–π–º –∏–∑–º–µ–Ω—ë–Ω –≤—Ä—É—á–Ω—É—é: {old_nick} ‚Üí {new_nick}\")\n\n        except discord.HTTPException as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ Discord –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∏–∫–Ω–µ–π–º–∞: {e}\")\n            if \"Missing Permissions\" in str(e) or \"50013\" in str(e):\n                await interaction.followup.send(\n                    \"‚ùå –£ –±–æ—Ç–∞ –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∏–∫–Ω–µ–π–º–æ–≤. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∞–≤ –±–æ—Ç–∞.\",\n                    ephemeral=True\n                )\n            else:\n                await interaction.followup.send(\"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∏–∫–Ω–µ–π–º–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç–∞.\", ephemeral=True)\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –≤ NicknameMismatchModal: {e}\")\n            await interaction.followup.send(\"‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.\", ephemeral=True)\n\n\nclass ManualNickFixModal(discord.ui.Modal):\n    def __init__(self, user_id: int, source_message_id: int = None, channel_id: int = None):\n        super().__init__(title=\"–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∏–∫–Ω–µ–π–º–∞ –≤—Ä—É—á–Ω—É—é\", timeout=None)\n        self.user_id = user_id\n        self.source_message_id = source_message_id  # FIX: —Å–æ—Ö—Ä–∞–Ω—è–µ–º ID –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è\n        self.channel_id = channel_id  # FIX: —Å–æ—Ö—Ä–∞–Ω—è–µ–º ID –∫–∞–Ω–∞–ª–∞\n\n    nickname_input = discord.ui.TextInput(label=\"SteamNick | –ò–º—è\", style=discord.TextStyle.short, max_length=32)\n\n    async def on_submit(self, interaction: discord.Interaction):\n        new_nick = self.nickname_input.value.strip()\n\n        try:\n            # FIX: prevent Unknown interaction (10062)\n            await interaction.response.defer(ephemeral=False)\n\n            member = interaction.guild.get_member(self.user_id)\n            if not member:\n                await interaction.followup.send(\n                    \"‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.\", ephemeral=True\n                )\n                return\n\n            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –Ω–∏–∫–∞\n            if len(new_nick) > 32:\n                await interaction.followup.send(\"–ù–∏–∫ –¥–ª–∏–Ω–Ω–µ–µ 32 —Å–∏–º–≤–æ–ª–æ–≤. –°–æ–∫—Ä–∞—Ç–∏—Ç–µ.\", ephemeral=True)\n                return\n\n            # –ü—Ä–∏–º–µ–Ω—è–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ\n            old_nick = member.nick or member.display_name\n            await member.edit(nick=new_nick, reason=\"–†—É—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∏–∫–∞ (modal)\")\n            logger.info(f\"–†—É—á–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∏–∫–∞ –¥–ª—è {member.id}: {old_nick} -> {new_nick}\")\n\n            # –ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∏–∫–∞ —á–µ—Ä–µ–∑ AI\n            nick_result = await decide_nickname(new_nick)\n            if not nick_result.approve:\n                public_reasons = nick_result.public_reasons or []\n                fixed_suggestion = nick_result.fixed_full\n\n                view = NicknameRecheckView(member.id, fixed_suggestion)\n                nickname_embed = build_nick_reject_embed(\n                    member, new_nick, public_reasons, fixed_suggestion\n                )\n\n                channel = interaction.client.get_channel(self.channel_id or interaction.channel.id)\n                if not channel:\n                    try:\n                        channel = await interaction.client.fetch_channel(self.channel_id or interaction.channel.id)\n                    except:\n                        channel = interaction.channel\n\n                if self.source_message_id:\n                    try:\n                        msg = await channel.fetch_message(self.source_message_id)\n                        await msg.edit(embed=nickname_embed, view=view)\n                    except discord.NotFound:\n                        await channel.send(embed=nickname_embed, view=view)\n                else:\n                    await channel.send(embed=nickname_embed, view=view)\n\n                await interaction.followup.send(\"–ù–∏–∫ –±—ã–ª –∏–∑–º–µ–Ω–µ–Ω, –Ω–æ –≤—Å—ë –µ—â—ë –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞–º.\", ephemeral=True)\n                return\n\n            # –ï—Å–ª–∏ –Ω–∏–∫ –æ–¥–æ–±—Ä–µ–Ω AI - –ø–∏–Ω–≥—É–µ–º –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ–¥–æ–±—Ä–µ–Ω–∏—è\n            success_embed = discord.Embed(\n                title=\"‚úÖ –ù–∏–∫–Ω–µ–π–º –ø—Ä–æ–≤–µ—Ä–µ–Ω –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞–º\",\n                description=f\"–ù–∏–∫–Ω–µ–π–º **{new_nick}** —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–µ–ª –ø—Ä–æ–≤–µ—Ä–∫—É AI\",\n                color=0x00FF00,\n                timestamp=datetime.now(timezone.utc),\n            )\n\n            success_embed.add_field(\n                name=\"üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏—è\",\n                value=f\"**–ë—ã–ª–æ:** `{member.display_name}`\\n**–°—Ç–∞–ª–æ:** `{new_nick}`\",\n                inline=False,\n            )\n\n            success_embed.add_field(\n                name=\"üë®‚Äçüíº –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–¥–æ–±—Ä–µ–Ω–∏–µ\",\n                value=\"<@&1208155641013821460> <@&1208155641013821461> –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞—è–≤–∫—É –∏ –ø—Ä–∏–º–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ.\",\n                inline=False,\n            )\n\n            # –°–æ–∑–¥–∞–µ–º view –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –∑–∞—è–≤–∫–∏\n            from handlers.novichok_actions import TicketActionView\n            approval_view = TicketActionView(member.id, \"manual_fix\")\n\n            channel = interaction.client.get_channel(self.channel_id or interaction.channel.id)\n            if not channel:\n                try:\n                    channel = await interaction.client.fetch_channel(self.channel_id or interaction.channel.id)\n                except:\n                    channel = interaction.channel\n\n            if self.source_message_id:\n                try:\n                    msg = await channel.fetch_message(self.source_message_id)\n                    await msg.edit(embed=success_embed, view=approval_view)\n                except discord.NotFound:\n                    await channel.send(embed=success_embed, view=approval_view)\n            else:\n                await channel.send(embed=success_embed, view=approval_view)\n\n            await interaction.followup.send(\"–ù–∏–∫ —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω –∏ –ø–µ—Ä–µ–¥–∞–Ω –Ω–∞ –æ–¥–æ–±—Ä–µ–Ω–∏–µ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º.\", ephemeral=True)\n\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –≤ on_submit ManualNickFixModal: {e}\")\n            await interaction.followup.send(\n                \"‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–∞—à–µ–≥–æ –Ω–∏–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.\",\n                ephemeral=True,\n            )\n\n\nclass NicknameRecheckView(discord.ui.View):\n    def __init__(\n        self,\n        user_id: int = None,\n        suggested_nick: Optional[str] = None,\n        *,\n        timeout: float | None = None\n    ):\n        super().__init__(timeout=None)\n        self.user_id = user_id\n        self.suggested_nick = suggested_nick\n\n    @discord.ui.button(\n        label=\"‚úÖ –ò—Å–ø—Ä–∞–≤—å –º–æ–π SteamNick | –ò–º—è\",\n        style=discord.ButtonStyle.success,\n        custom_id=\"auto_fix_nickname_v2\",\n    )\n    async def auto_fix_nickname(self,\n        interaction: discord.Interaction,\n        button: discord.ui.Button\n    ):\n        \"\"\"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∏–∫–∞\"\"\"\n        try:\n            member = interaction.guild.get_member(self.user_id)\n            if not member:\n                await interaction.response.send_message(\n                    \"‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.\", ephemeral=True\n                )\n                return\n\n            if not self.suggested_nick:\n                await interaction.response.send_message(\n                    \"‚ùå –ù–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –Ω–∏–∫–Ω–µ–π–º–∞.\", ephemeral=True\n                )\n                return\n\n            # FIX: –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ fixed_full\n            await member.edit(\n                nick=self.suggested_nick,\n                reason=\"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∏–∫–Ω–µ–π–º–∞ –ø–æ –∑–∞—è–≤–∫–µ\",\n            )\n\n            # FIX: –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º embed \"–ì–æ—Ç–æ–≤–æ. –ó–∞–ø—É—Å–∫–∞—é –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∫—É...\"\n            processing_embed = discord.Embed(\n                title=\"‚úÖ –ù–∏–∫–Ω–µ–π–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω!\",\n                description=f\"–í–∞—à –Ω–∏–∫–Ω–µ–π–º –∏–∑–º–µ–Ω—ë–Ω –Ω–∞: **{self.suggested_nick}**\\n\\nüîÑ –ó–∞–ø—É—Å–∫–∞—é –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∫—É...\",\n                color=0x00FF00,\n                timestamp=datetime.now(timezone.utc),\n            )\n            await interaction.response.edit_message(embed=processing_embed, view=None)\n\n            # FIX: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É\n            await asyncio.sleep(2)  # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∏–∫–Ω–µ–π–º–∞\n\n            # –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∏ –µ—Å–ª–∏ OK, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏–Ω—è—Ç—å/–æ—Ç–∫–∞–∑–∞—Ç—å\n            await self.recheck_application_logic(interaction.channel, member)\n\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∏–∫–∞: {e}\")\n            await interaction.response.send_message(f\"–ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫: {e}\", ephemeral=True)\n\n    @discord.ui.button(label=\"–Ø –∏—Å–ø—Ä–∞–≤–ª—é —Å–∞–º\", style=discord.ButtonStyle.secondary, custom_id=\"nick_manual_fix_v2\")\n    async def manual_fix_button(self, interaction: discord.Interaction, button: discord.ui.Button):\n        \"\"\"–†—É—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ modal\"\"\"\n        # FIX: –ø–µ—Ä–µ–¥–∞—ë–º ID –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –∫–∞–Ω–∞–ª–∞\n        modal = ManualNickFixModal(\n            self.user_id,\n            source_message_id=interaction.message.id,\n            channel_id=interaction.channel.id\n        )\n        await interaction.response.send_modal(modal)\n\n    # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏\n    async def recheck_application_logic(self, channel, member):\n        \"\"\"–ü–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞—è–≤–∫–∏\"\"\"\n        try:\n            # –ò–º–∏—Ç–∏—Ä—É–µ–º –≤—ã–∑–æ–≤ analyze_and_respond_to_application\n            # –í —Ä–µ–∞–ª—å–Ω–æ–º –∫–æ–¥–µ –≤–∞–º –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Å—Ç–∞–Ω—Å—É Cog\n            # –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã, –∑–¥–µ—Å—å –º—ã –≤—ã–∑—ã–≤–∞–µ–º decide_nickname –Ω–∞–ø—Ä—è–º—É—é\n            # FIX: await –≤—ã–∑–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∏–∫–Ω–µ–π–º–∞\n            nick_result = await decide_nickname(member.display_name)\n            if not nick_result.approve:  # FIX: –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫–∞–∫ –∫ –∞—Ç—Ä–∏–±—É—Ç—É\n                public_reasons = nick_result.public_reasons or []  # FIX: –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫–∞–∫ –∫ –∞—Ç—Ä–∏–±—É—Ç—É\n                fixed_suggestion = nick_result.fixed_full  # FIX: –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫–∞–∫ –∫ –∞—Ç—Ä–∏–±—É—Ç—É\n\n                # FIX: –∑–µ–ª—ë–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å fixed_full\n                view = NicknameRecheckView(member.id, fixed_suggestion)\n                nickname_embed = build_nick_reject_embed(\n                    member, member.display_name, public_reasons, fixed_suggestion\n                )\n                await safe_send_message(\n                    channel,\n                    embed=nickname_embed,\n                    view=view\n                )\n            else:\n                # –ù–∏–∫ –æ–¥–æ–±—Ä–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è\n                ok_embed = build_nick_ok_embed(member.display_name)\n                # –ó–ê–ú–ï–ù–ò–¢–ï ApplicationDecisionView –Ω–∞ –≤–∞—à –∫–ª–∞—Å—Å View –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è\n                # –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∫–ª–∞—Å—Å TicketDecisionView, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ\n                # –î–ª—è –ø—Ä–∏–º–µ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º TicketActionView, –Ω–æ –≤–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –∑–∞–º–µ–Ω–∏—Ç—å –µ–≥–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π\n                from handlers.novichok_actions import TicketActionView\n                accept_view = TicketActionView(member.id, \"unknown\") # <-- –ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –í–ê–® –ö–õ–ê–°–° VIEW\n                await safe_send_message(channel, embed=ok_embed, view=accept_view)\n\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ –∑–∞—è–≤–∫–∏: {e}\")\n            await safe_send_message(\n                channel,\n                f\"{member.mention} ‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—É.\"\n            )\n\n\nclass NicknameFixView(discord.ui.View):\n    \"\"\"View –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö –Ω–∏–∫–Ω–µ–π–º–æ–≤\"\"\"\n\n    def __init__(self, user_id: int = None, original_nick: str = \"\", suggested_nick: str = \"\", steam_nick: str = \"\"):\n        super().__init__(timeout=None)\n        self.user_id = user_id or 0\n        self.original_nick = original_nick\n        self.suggested_nick = suggested_nick\n        self.steam_nick = steam_nick\n\n    @discord.ui.button(\n        label=\"‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏\",\n        style=discord.ButtonStyle.success,\n        custom_id=\"auto_fix_steam_nick_v3\",\n    )\n    async def auto_fix_nick(self, interaction: discord.Interaction, button: discord.ui.Button):\n        \"\"\"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∏–∫–Ω–µ–π–º–∞\"\"\"\n        try:\n            member = interaction.guild.get_member(self.user_id)\n            if not member:\n                await interaction.response.send_message(\"‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω.\", ephemeral=True)\n                return\n\n            # –ü—Ä–∏–º–µ–Ω—è–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –Ω–∏–∫–Ω–µ–π–º\n            await member.edit(\n                nick=self.suggested_nick,\n                reason=\"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∏–∫–Ω–µ–π–º–∞ –ø–æ Steam –ø—Ä–æ—Ñ–∏–ª—é\"\n            )\n\n            # –°–æ–∑–¥–∞–µ–º embed –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è\n            success_embed = discord.Embed(\n                title=\"‚úÖ –ù–∏–∫–Ω–µ–π–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω\",\n                description=f\"–ù–∏–∫ –∏–≥—Ä–æ–∫–∞ **{self.original_nick}** –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ **{self.suggested_nick}**\",\n                color=0x00FF00,\n                timestamp=datetime.now(timezone.utc),\n            )\n\n            success_embed.add_field(\n                name=\"üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏—è\",\n                value=f\"**–ë—ã–ª–æ:** `{self.original_nick}`\\n**–°—Ç–∞–ª–æ:** `{self.suggested_nick}`\",\n                inline=False,\n            )\n\n            await interaction.response.edit_message(embed=success_embed, view=None)\n\n            # –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞—è–≤–∫–∏\n            await asyncio.sleep(2)\n            await self._recheck_application(interaction.channel, member)\n\n            logger.info(f\"‚úÖ –ù–∏–∫–Ω–µ–π–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω: {self.original_nick} ‚Üí {self.suggested_nick}\")\n\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∏–∫–Ω–µ–π–º–∞: {e}\")\n            await interaction.response.send_message(\"‚ùå –û—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∏–∫–Ω–µ–π–º–∞.\", ephemeral=True)\n\n    @discord.ui.button(\n        label=\"üîß –ò—Å–ø—Ä–∞–≤–ª—é —Å–∞–º\",\n        style=discord.ButtonStyle.secondary,\n        custom_id=\"manual_fix_steam_nick_v3\",\n    )\n    async def manual_fix_nick(self, interaction: discord.Interaction, button: discord.ui.Button):\n        \"\"\"–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –≤—Ä—É—á–Ω—É—é\"\"\"\n        try:\n            manual_embed = discord.Embed(\n                title=\"üîß –ò—Å–ø—Ä–∞–≤—å—Ç–µ –Ω–∏–∫–Ω–µ–π–º –≤—Ä—É—á–Ω—É—é\",\n                description=f\"–ò—Å–ø—Ä–∞–≤—å—Ç–µ —Å–≤–æ–π Discord –Ω–∏–∫–Ω–µ–π–º –Ω–∞ **{self.suggested_nick}** –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É \"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞—è–≤–∫—É –µ—â—ë —Ä–∞–∑\"\",\n                color=0x0099FF,\n            )\n\n            manual_embed.add_field(\n                name=\"üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è\",\n                value=\"1. –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –Ω–∞ —Å–≤–æ–π –Ω–∏–∫ –≤ Discord\\n2. –í—ã–±–µ—Ä–∏—Ç–µ \"–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫–Ω–µ–π–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ\"\\n3. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –Ω–∏–∫\\n4. –ù–∞–∂–º–∏—Ç–µ \"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞—è–≤–∫—É –µ—â—ë —Ä–∞–∑\"\",\n                inline=False,\n            )\n\n            await interaction.response.edit_message(embed=manual_embed, view=None)\n\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ —Ä—É—á–Ω–æ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏: {e}\")\n\n    async def _recheck_application(self, channel, member):\n        \"\"\"–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞—è–≤–∫–∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∏–∫–∞\"\"\"\n        try:\n            # –ü–æ–ª—É—á–∞–µ–º TicketHandler\n            bot = channel.guild._state._get_client()\n            ticket_handler = bot.get_cog(\"TicketHandler\")\n            if ticket_handler:\n                await ticket_handler.analyze_and_respond_to_application(channel, member)\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏: {e}\")\n\n\nclass NicknameFixView(discord.ui.View):\n    \"\"\"View –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö –Ω–∏–∫–Ω–µ–π–º–æ–≤\"\"\"\n\n    def __init__(self, user_id: int = None, original_nick: str = \"\", suggested_nick: str = \"\", steam_nick: str = \"\"):\n        super().__init__(timeout=None)\n        self.user_id = user_id or 0\n        self.original_nick = original_nick\n        self.suggested_nick = suggested_nick\n        self.steam_nick = steam_nick\n\n    @discord.ui.button(\n        label=\"‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏\",\n        style=discord.ButtonStyle.success,\n        custom_id=\"auto_fix_steam_nick_v3\",\n    )\n    async def auto_fix_nick(self, interaction: discord.Interaction, button: discord.ui.Button):\n        \"\"\"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∏–∫–Ω–µ–π–º–∞\"\"\"\n        try:\n            member = interaction.guild.get_member(self.user_id)\n            if not member:\n                await interaction.response.send_message(\"‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω.\", ephemeral=True)\n                return\n\n            # –ü—Ä–∏–º–µ–Ω—è–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –Ω–∏–∫–Ω–µ–π–º\n            await member.edit(\n                nick=self.suggested_nick,\n                reason=\"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∏–∫–Ω–µ–π–º–∞ –ø–æ Steam –ø—Ä–æ—Ñ–∏–ª—é\"\n            )\n\n            # –°–æ–∑–¥–∞–µ–º embed –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è\n            success_embed = discord.Embed(\n                title=\"‚úÖ –ù–∏–∫–Ω–µ–π–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω\",\n                description=f\"–ù–∏–∫ –∏–≥—Ä–æ–∫–∞ **{self.original_nick}** –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ **{self.suggested_nick}**\",\n                color=0x00FF00,\n                timestamp=datetime.now(timezone.utc),\n            )\n\n            success_embed.add_field(\n                name=\"üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏—è\",\n                value=f\"**–ë—ã–ª–æ:** `{self.original_nick}`\\n**–°—Ç–∞–ª–æ:** `{self.suggested_nick}`\",\n                inline=False,\n            )\n\n            await interaction.response.edit_message(embed=success_embed, view=None)\n\n            # –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞—è–≤–∫–∏\n            await asyncio.sleep(2)\n            await self._recheck_application(interaction.channel, member)\n\n            logger.info(f\"‚úÖ –ù–∏–∫–Ω–µ–π–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω: {self.original_nick} ‚Üí {self.suggested_nick}\")\n\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∏–∫–Ω–µ–π–º–∞: {e}\")\n            await interaction.response.send_message(\"‚ùå –û—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∏–∫–Ω–µ–π–º–∞.\", ephemeral=True)\n\n    @discord.ui.button(\n        label=\"üîß –ò—Å–ø—Ä–∞–≤–ª—é —Å–∞–º\",\n        style=discord.ButtonStyle.secondary,\n        custom_id=\"manual_fix_steam_nick_v3\",\n    )\n    async def manual_fix_nick(self, interaction: discord.Interaction, button: discord.ui.Button):\n        \"\"\"–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –≤—Ä—É—á–Ω—É—é\"\"\"\n        try:\n            manual_embed = discord.Embed(\n                title=\"üîß –ò—Å–ø—Ä–∞–≤—å—Ç–µ –Ω–∏–∫–Ω–µ–π–º –≤—Ä—É—á–Ω—É—é\",\n                description=f\"–ò—Å–ø—Ä–∞–≤—å—Ç–µ —Å–≤–æ–π Discord –Ω–∏–∫–Ω–µ–π–º –Ω–∞ **{self.suggested_nick}** –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É \"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞—è–≤–∫—É –µ—â—ë —Ä–∞–∑\"\",\n                color=0x0099FF,\n            )\n\n            manual_embed.add_field(\n                name=\"üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è\",\n                value=\"1. –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –Ω–∞ —Å–≤–æ–π –Ω–∏–∫ –≤ Discord\\n2. –í—ã–±–µ—Ä–∏—Ç–µ \"–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫–Ω–µ–π–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ\"\\n3. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –Ω–∏–∫\\n4. –ù–∞–∂–º–∏—Ç–µ \"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞—è–≤–∫—É –µ—â—ë —Ä–∞–∑\"\",\n                inline=False,\n            )\n\n            await interaction.response.edit_message(embed=manual_embed, view=None)\n\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ —Ä—É—á–Ω–æ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏: {e}\")\n\n    async def _recheck_application(self, channel, member):\n        \"\"\"–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞—è–≤–∫–∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∏–∫–∞\"\"\"\n        try:\n            # –ü–æ–ª—É—á–∞–µ–º TicketHandler\n            bot = channel.guild._state._get_client()\n            ticket_handler = bot.get_cog(\"TicketHandler\")\n            if ticket_handler:\n                await ticket_handler.analyze_and_respond_to_application(channel, member)\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏: {e}\")\n\n\nclass NicknameMismatchFixView(discord.ui.View):\n    \"\"\"View –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö Discord –∏ Steam –Ω–∏–∫–Ω–µ–π–º–æ–≤\"\"\"\n\n    def __init__(self, user_id: int = None, discord_nick: str = None, steam_nick: str = None, real_name: str = None):\n        super().__init__(timeout=None)\n        self.user_id = user_id or 0\n        self.discord_nick = discord_nick or \"\"\n        self.steam_nick = steam_nick or \"\"\n        self.real_name = real_name or \"\"\n\n    @discord.ui.button(\n        label=\"–ò—Å–ø—Ä–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏\",\n        style=discord.ButtonStyle.success,\n        custom_id=\"auto_fix_nick_mismatch_v4\",\n    )\n    async def auto_fix_nickname(self, interaction: discord.Interaction, button: discord.ui.Button):\n        \"\"\"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Discord –Ω–∏–∫–Ω–µ–π–º–∞ –Ω–∞ —Ñ–æ—Ä–º–∞—Ç SteamNick | –ò–º—è\"\"\"\n        try:\n            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –ª–∏ —É–∂–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ\n            if interaction.response.is_done():\n                logger.warning(f\"‚ö†Ô∏è Interaction —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è {interaction.user.display_name}\")\n                return\n\n            member = interaction.guild.get_member(self.user_id)\n            if not member:\n                await interaction.response.send_message(\"‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω.\", ephemeral=True)\n                return\n\n            # –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –Ω–∏–∫–Ω–µ–π–º\n            new_nick = f\"{self.steam_nick} | {self.real_name}\"\n\n            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–ª–∏–Ω—É –Ω–∏–∫–∞ (Discord –ª–∏–º–∏—Ç 32 —Å–∏–º–≤–æ–ª–∞)\n            if len(new_nick) > 32:\n                await interaction.response.send_message(\n                    f\"‚ùå –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–π –Ω–∏–∫–Ω–µ–π–º —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π ({len(new_nick)} —Å–∏–º–≤–æ–ª–æ–≤). –ú–∞–∫—Å–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞.\",\n                    ephemeral=True\n                )\n                return\n\n            # –°–Ω–∞—á–∞–ª–∞ –æ—Ç–≤–µ—á–∞–µ–º –Ω–∞ interaction, –∑–∞—Ç–µ–º –º–µ–Ω—è–µ–º –Ω–∏–∫\n            await interaction.response.defer()\n\n            # –ü—Ä–∏–º–µ–Ω—è–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –Ω–∏–∫–Ω–µ–π–º\n            await member.edit(\n                nick=new_nick,\n                reason=\"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∏–∫–Ω–µ–π–º–∞ –ø–æ Steam –ø—Ä–æ—Ñ–∏–ª—é\"\n            )\n\n            # –°–æ–∑–¥–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è\n            success_message = (\n                f\"‚úÖ **–ù–∏–∫–Ω–µ–π–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω!**\\n\\n\"\n                f\"üîÑ **–ò–∑–º–µ–Ω–µ–Ω–∏—è:**\\n\"\n                f\"‚Ä¢ –ë—ã–ª–æ: `{self.discord_nick}`\\n\"\n                f\"‚Ä¢ –°—Ç–∞–ª–æ: `{new_nick}`\\n\\n\"\n                f\"üîÑ **–ó–∞–ø—É—Å–∫–∞—é –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞—è–≤–∫–∏...**\"\n            )\n\n            await interaction.edit_original_response(content=success_message, view=None)\n\n            # –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞—è–≤–∫–∏\n            await asyncio.sleep(3)\n            await self._recheck_application(interaction.channel, member)\n\n            logger.info(f\"‚úÖ –ù–∏–∫–Ω–µ–π–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω: {self.discord_nick} ‚Üí {new_nick}\")\n\n        except discord.HTTPException as e:\n            try:\n                if not interaction.response.is_done():\n                    if \"Invalid Form Body\" in str(e):\n                        await interaction.response.send_message(\"‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–∏–∫–Ω–µ–π–º. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é.\", ephemeral=True)\n                    elif \"Missing Permissions\" in str(e) or \"50013\" in str(e):\n                        await interaction.response.send_message(\n                            \"‚ùå –£ –±–æ—Ç–∞ –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∏–∫–Ω–µ–π–º–æ–≤. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∞–≤ –±–æ—Ç–∞ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º –≤—Ä—É—á–Ω—É—é.\",\n                            ephemeral=True\n                        )\n                    else:\n                        await interaction.response.send_message(\"‚ùå –û—à–∏–±–∫–∞ Discord API –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∏–∫–Ω–µ–π–º–∞.\", ephemeral=True)\n                else:\n                    await interaction.followup.send(\"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∏–∫–Ω–µ–π–º–∞.\", ephemeral=True)\n            except:\n                logger.error(f\"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ: {e}\")\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∏–∫–Ω–µ–π–º–∞: {e}\")\n            try:\n                if not interaction.response.is_done():\n                    await interaction.response.send_message(\"‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é.\", ephemeral=True)\n                else:\n                    await interaction.followup.send(\"‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é.\", ephemeral=True)\n            except:\n                logger.error(f\"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ: {e}\")\n\n    @discord.ui.button(\n        label=\"–ò—Å–ø—Ä–∞–≤–ª—é —Å–∞–º\",\n        style=discord.ButtonStyle.danger,\n        custom_id=\"manual_fix_nick_mismatch_v4\",\n    )\n    async def manual_fix_nickname(self, interaction: discord.Interaction, button: discord.ui.Button):\n        \"\"\"–û—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∏–∫–Ω–µ–π–º–∞\"\"\"\n        try:\n            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –ª–∏ —É–∂–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ\n            if interaction.response.is_done():\n                logger.warning(f\"‚ö†Ô∏è Interaction —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ {interaction.user.display_name}\")\n                return\n\n            # –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π\n            modal = NicknameMismatchModal(\n                self.user_id,\n                self.steam_nick,\n                self.real_name,\n                interaction.message.id,\n                interaction.channel.id\n            )\n            await interaction.response.send_modal(modal)\n\n        except discord.HTTPException as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞: {e}\")\n            try:\n                if not interaction.response.is_done():\n                    await interaction.response.send_message(\"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä–º—ã –¥–ª—è –≤–≤–æ–¥–∞ –Ω–∏–∫–Ω–µ–π–º–∞.\", ephemeral=True)\n                else:\n                    await interaction.followup.send(\"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä–º—ã –¥–ª—è –≤–≤–æ–¥–∞ –Ω–∏–∫–Ω–µ–π–º–∞.\", ephemeral=True)\n            except:\n                pass\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞: {e}\")\n            try:\n                if not interaction.response.is_done():\n                    await interaction.response.send_message(\"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä–º—ã –¥–ª—è –≤–≤–æ–¥–∞ –Ω–∏–∫–Ω–µ–π–º–∞.\", ephemeral=True)\n                else:\n                    await interaction.followup.send(\"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä–º—ã –¥–ª—è –≤–≤–æ–¥–∞ –Ω–∏–∫–Ω–µ–π–º–∞.\", ephemeral=True)\n            except:\n                pass\n\n    async def _recheck_application(self, channel, member):\n        \"\"\"–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞—è–≤–∫–∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∏–∫–∞\"\"\"\n        try:\n            # –ü–æ–ª—É—á–∞–µ–º TicketHandler\n            bot = channel.guild._state._get_client()\n            ticket_handler = bot.get_cog(\"TicketHandler\")\n            if ticket_handler:\n                await ticket_handler.analyze_and_respond_to_application(channel, member)\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏: {e}\")\n            await safe_send_message(\n                channel,\n                f\"{member.mention} ‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ –∑–∞—è–≤–∫–∏. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—É.\"\n            )\n\n\nclass TicketHandler(commands.Cog):\n    \"\"\"–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞—è–≤–æ–∫\"\"\"\n    def __init__(self, bot: commands.Bot):\n        self.bot = bot\n        self._welcomed_channels = set()\n\n    async def process_new_ticket(self, channel, user):\n        \"\"\"–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤–æ–≥–æ —Ç–∏–∫–µ—Ç–∞\"\"\"\n        try:\n            if channel.id not in self._welcomed_channels:\n                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ\n                await safe_send_message(\n                    channel,\n                    f\"üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {user.mention}! –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞ –∫ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—é.\\n\"\n                    f\"üîç –°–µ–π—á–∞—Å –ø—Ä–æ–≤–µ—Ä–∏–º –≤–∞—à Steam-–ø—Ä–æ—Ñ–∏–ª—å –∏ –Ω–∏–∫–Ω–µ–π–º...\"\n                )\n                self._welcomed_channels.add(channel.id)\n                logger.info(f\"‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ {channel.name}\")\n\n            # –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∞–ª–∏–∑ –∑–∞—è–≤–∫–∏\n            await self.analyze_and_respond_to_application(channel, user)\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤–æ–≥–æ —Ç–∏–∫–µ—Ç–∞: {e}\")\n\n    async def analyze_and_respond_to_application(self, channel, user):\n        \"\"\"–ê–Ω–∞–ª–∏–∑ –∏ –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞—è–≤–∫—É\"\"\"\n        try:\n            await safe_send_message(\n                channel,\n                f\"üîç –ó–∞–ø—É—â–µ–Ω –∞–Ω–∞–ª–∏–∑ –≤–∞—à–µ–π –∑–∞—è–≤–∫–∏...\\n\"\n                f\"‚è∞ –ü—Ä–æ–≤–µ—Ä—è—é Steam-–ø—Ä–æ—Ñ–∏–ª—å –∏ –Ω–∏–∫–Ω–µ–π–º...\"\n            )\n\n            # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n            member = channel.guild.get_member(user.id)\n            if not member:\n                logger.warning(f\"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user.id} –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.\")\n                return\n\n            # –ü–æ–ª—É—á–∞–µ–º Discord –Ω–∏–∫\n            discord_nick = member.nick or member.display_name\n\n            # –ò—â–µ–º Steam —Å—Å—ã–ª–∫–∏ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∫–∞–Ω–∞–ª–∞\n            steam_profile_url = None\n            steam_id64 = None\n            steam_nick = None\n\n            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ Steam —Å—Å—ã–ª–æ–∫\n            async for message in channel.history(limit=20):\n                if message.embeds:\n                    for embed in message.embeds:\n                        if embed.fields:\n                            for field in embed.fields:\n                                if field.value and \"steamcommunity.com\" in field.value:\n                                    from handlers.novichok import extract_steam_links\n                                    steam_links = extract_steam_links(field.value)\n                                    if steam_links:\n                                        steam_profile_url = steam_links[0]\n                                        break\n                        if steam_profile_url:\n                            break\n                if steam_profile_url:\n                    break\n\n            if not steam_profile_url:\n                await safe_send_message(\n                    channel,\n                    f\"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ Steam –ø—Ä–æ—Ñ–∏–ª—å –≤ –∑–∞—è–≤–∫–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–∫–∞–∑–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ Steam –ø—Ä–æ—Ñ–∏–ª—å.\"\n                )\n                return\n\n            # –ü–æ–ª—É—á–∞–µ–º SteamID64 –∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è\n            from handlers.steam_api import get_steam_id64, steam_client\n\n            steam_id64 = await get_steam_id64(steam_profile_url)\n            if steam_id64:\n                steam_data = await steam_client.get_player_summary(steam_id64)\n                if steam_data and steam_data.get(\"success\"):\n                    steam_nick = steam_data.get(\"personaname\", \"\")\n\n            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ Discord –Ω–∏–∫–∞ –∏ Steam –Ω–∏–∫–∞\n            nick_match = False\n            if discord_nick and steam_nick:\n                # –£–±–∏—Ä–∞–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–µ—Ñ–∏–∫—Å—ã –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —á–∞—Å—Ç—å –Ω–∏–∫–∞\n                discord_left = discord_nick.split(' | ')[0].strip() if ' | ' in discord_nick else discord_nick.strip()\n                steam_nick_clean = steam_nick.strip()\n\n                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ\n                if discord_left.lower() == steam_nick_clean.lower():\n                    nick_match = True\n                else:\n                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å —É—á–µ—Ç–æ–º –∫–ª–∞–Ω–æ–≤—ã—Ö –ø—Ä–∏—Å—Ç–∞–≤–æ–∫ (VLG., [VLG], etc.)\n                    # –£–±–∏—Ä–∞–µ–º –∫–ª–∞–Ω–æ–≤—ã–µ –ø—Ä–∏—Å—Ç–∞–≤–∫–∏ –∏–∑ Steam –Ω–∏–∫–∞\n                    steam_without_clan = re.sub(r'^(VLG\\.|VLG_|\[VLG\]|VLG)', '', steam_nick_clean, flags=re.IGNORECASE).strip()\n                    discord_without_clan = re.sub(r'^(VLG\\.|VLG_|\[VLG\]|VLG)', '', discord_left, flags=re.IGNORECASE).strip()\n\n                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –±–µ–∑ –∫–ª–∞–Ω–æ–≤—ã—Ö –ø—Ä–∏—Å—Ç–∞–≤–æ–∫\n                    if discord_without_clan.lower() == steam_without_clan.lower():\n                        nick_match = True\n                        logger.info(f\"‚úÖ –ù–∏–∫–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∞–Ω–æ–≤—ã—Ö –ø—Ä–∏—Å—Ç–∞–≤–æ–∫: '{discord_without_clan}' == '{steam_without_clan}'\")\n                    else:\n                        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ö–æ–∂–µ—Å—Ç—å (—É—á–∏—Ç—ã–≤–∞–µ–º –æ–ø–µ—á–∞—Ç–∫–∏)\n                        from difflib import SequenceMatcher\n                        similarity = SequenceMatcher(None, discord_without_clan.lower(), steam_without_clan.lower()).ratio()\n                        if similarity >= 0.85:  # 85% —Å—Ö–æ–∂–µ—Å—Ç–∏\n                            nick_match = True\n                            logger.info(f\"‚úÖ –ù–∏–∫–∏ —Å—Ö–æ–∂–∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∞–Ω–æ–≤—ã—Ö –ø—Ä–∏—Å—Ç–∞–≤–æ–∫: '{discord_without_clan}' ~ '{steam_without_clan}' (—Å—Ö–æ–∂–µ—Å—Ç—å: {similarity:.2f})\")\n\n            if not nick_match and discord_nick and steam_nick:\n                # –ù–∏–∫–Ω–µ–π–º—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ\n                from utils.misc import extract_real_name_from_discord_nick\n                real_name = extract_real_name_from_discord_nick(discord_nick)\n\n                if not real_name:\n                    # –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å –∏–º—è –∏–∑ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ –Ω–∏–∫–∞ Discord\n                    if ' | ' in discord_nick:\n                        real_name = discord_nick.split(' | ', 1)[1].strip()\n                    else:\n                        real_name = \"–í–∞—à–µ –∏–º—è\"  # fallback\n\n                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –≤–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ\n                if getattr(config, \"DEBUG_NICKNAME_CHECKS\", False):\n                    # –í—ã—á–∏—Å–ª—è–µ–º –æ—á–∏—â–µ–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è\n                    discord_left = discord_nick.split(' | ')[0].strip() if ' | ' in discord_nick else discord_nick.strip()\n                    steam_nick_clean = steam_nick.strip()\n\n                    # –£–±–∏—Ä–∞–µ–º –∫–ª–∞–Ω–æ–≤—ã–µ –ø—Ä–∏—Å—Ç–∞–≤–∫–∏\n                    import re\n                    steam_without_clan = re.sub(r'^(VLG\\.|VLG_|\[VLG\]|VLG)', '', steam_nick_clean, flags=re.IGNORECASE).strip()\n                    discord_without_clan = re.sub(r'^(VLG\\.|VLG_|\[VLG\]|VLG)', '', discord_left, flags=re.IGNORECASE).strip()\n\n                    logger.info(f\"üîç DEBUG: –î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –Ω–∏–∫–æ–≤:\")\n                    logger.info(f\"   –ò—Å—Ö–æ–¥–Ω—ã–π Discord –Ω–∏–∫: '{discord_nick}'\")\n                    logger.info(f\"   –ò—Å—Ö–æ–¥–Ω—ã–π Steam –Ω–∏–∫: '{steam_nick}'\")\n                    logger.info(f\"   Discord –ª–µ–≤–∞—è —á–∞—Å—Ç—å: '{discord_left}'\")\n                    logger.info(f\"   Steam –æ—á–∏—â–µ–Ω–Ω—ã–π: '{steam_nick_clean}'\")\n                    logger.info(f\"   Discord –±–µ–∑ –∫–ª–∞–Ω–∞: '{discord_without_clan}'\")\n                    logger.info(f\"   Steam –±–µ–∑ –∫–ª–∞–Ω–∞: '{steam_without_clan}'\")\n                    logger.info(f\"   –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ: {discord_left.lower() == steam_nick_clean.lower()}\")\n                    logger.info(f\"   –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –±–µ–∑ –∫–ª–∞–Ω–∞: {discord_without_clan.lower() == steam_without_clan.lower()}\")\n                    logger.info(f\"   –°—Ö–æ–∂–µ—Å—Ç—å (0.0-1.0): {similarity:.3f}\")\n                    logger.info(f\"   –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ nick_match: {nick_match}\")\n\n                if discord_name_clean != steam_name_clean:\n                    logger.warning(f\"‚ùå –ù–∏–∫–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç –¥–ª—è {user.display_name}\")\n\n                    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞—Å—Ç–æ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –Ω–∏–∫–æ–≤\n                    mismatch_embed = discord.Embed(\n                        title=\"‚ùå –ù–∏–∫–Ω–µ–π–º –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç Steam –ø—Ä–æ—Ñ–∏–ª—é\",\n                        description=(\n                            f\"**–í–∞—à Discord –Ω–∏–∫:** `{discord_nick}`\\n\"\n                            f\"**–í–∞—à Steam –Ω–∏–∫:** `{steam_nick}`\\n\\n\"\n                            \"**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**\\n\"\n                            \"‚Ä¢ Discord –Ω–∏–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ: `SteamNick | –ò–º—è`\\n\"\n                            \"‚Ä¢ SteamNick –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –≤–∞—à–∏–º –Ω–∏–∫–æ–º –≤ Steam\\n\"\n                            \"‚Ä¢ –ò–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞ –∫–∏—Ä–∏–ª–ª–∏—Ü–µ —Å –∑–∞–≥–ª–∞–≤–Ω–æ–π –±—É–∫–≤—ã\"\n                        ),\n                        color=0xFF0000\n                    )\n\n                    mismatch_embed.add_field(\n                        name=\"üîß –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:\",\n                        value=(\n                            \"1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å–≤–æ–π –Ω–∏–∫ –≤ Discord\\n\"\n                            \"2. –í—ã–±–µ—Ä–∏—Ç–µ \"–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫–Ω–µ–π–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ\"\\n\"\n                            f\"3. –í–≤–µ–¥–∏—Ç–µ: `{steam_nick} | –í–∞—à–µ–ò–º—è}`\\n\"\n                            \"4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É \"–ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏—Ç—å\" –Ω–∏–∂–µ\"\n                        ),\n                        inline=False\n                    )\n\n                    view = NicknameMismatchFixView(user.id, discord_nick, steam_nick, \"\")\n                    await safe_send_message(channel, embed=mismatch_embed, view=view)\n\n                    # –í–ê–ñ–ù–û: –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ AI\n                    return\n\n\n            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç Discord –Ω–∏–∫–Ω–µ–π–º–∞ (–ë–ê–ó–û–í–ê–Ø –ü–†–û–í–ï–†–ö–ê –°–ù–ê–ß–ê–õ–ê)\n            await asyncio.sleep(2)\n\n            current_nick = user.nick or user.display_name\n            logger.info(f\"üîç –ü—Ä–æ–≤–µ—Ä—è—é —Ñ–æ—Ä–º–∞—Ç –Ω–∏–∫–Ω–µ–π–º–∞: {current_nick}\")\n\n            # –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –°–Ω–∞—á–∞–ª–∞ –±–∞–∑–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞\n            if \" | \" not in current_nick:\n                nickname_embed = discord.Embed(\n                    title=\"‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–∏–∫–Ω–µ–π–º–∞\",\n                    description=f\"**–í–∞—à –Ω–∏–∫–Ω–µ–π–º:** `{current_nick}`\\n\\n**–¢—Ä–µ–±—É–µ—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç:** `SteamNick | –ò–º—è`\",\n                    color=0xFF0000\n                )\n                nickname_embed.add_field(\n                    name=\"üìã –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:\",\n                    value=\"1. –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –Ω–∞ —Å–≤–æ–π –Ω–∏–∫ –≤ Discord\\n2. –í—ã–±–µ—Ä–∏—Ç–µ \"–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫–Ω–µ–π–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ\"\\n3. –í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫ –≤ —Ñ–æ—Ä–º–∞—Ç–µ: `SteamNick | –ò–º—è`\",\n                    inline=False\n                )\n\n                await safe_send_message(channel, embed=nickname_embed)\n                logger.warning(f\"‚ùå –ù–∏–∫–Ω–µ–π–º '{current_nick}' –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è ' | '\")\n                return\n\n            # –ñ–ï–°–¢–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: —Ç–æ—á–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å \" | \"\n            parts = current_nick.split(\" | \")\n            if len(parts) != 2:\n                # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –¥–≤–∞ –∏–ª–∏ –±–æ–ª–µ–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π \" | \"\n                steam_part = parts[0] if parts else \"\"\n\n                # –ü–æ–ø—ã—Ç–∫–∞ —É–≥–∞–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π —á–∞—Å—Ç–∏\n                suggested_name = parts[-1] if len(parts) > 1 else \"–í–∞—à–µ_–ò–º—è\"\n                suggested_nick = f\"{steam_part} | {suggested_name}\" if steam_part else f\"SteamNick | {suggested_name}\"\n\n                nickname_embed = discord.Embed(\n                    title=\"‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–∏–∫–Ω–µ–π–º–∞\",\n                    description=(\n                        f\"**–í–∞—à –Ω–∏–∫–Ω–µ–π–º:** `{current_nick}`\\n\\n\"\n                        f\"**üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê:** –ù–∞–π–¥–µ–Ω–æ **{len(parts)-1}** —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π \" | \", –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–¢–û–õ–¨–ö–û –û–î–ò–ù**\\n\\n\"\n                        f\"**‚úÖ –¢—Ä–µ–±—É–µ—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç:** `SteamNick | –ò–º—è`\\n\"\n                        f\"**‚ùå –£ –≤–∞—Å:** `{' | '.join(['—á–∞—Å—Ç—å'+str(i+1) for i in range(len(parts))])}`\"\n                    ),\n                    color=0xFF0000\n                )\n\n                nickname_embed.add_field(\n                    name=\"üîß –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:\",\n                    value=f\"`{suggested_nick}`\",\n                    inline=False\n                )\n\n                nickname_embed.add_field(\n                    name=\"üìã –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:\",\n                    value=\"1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É \"‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏\" –Ω–∏–∂–µ\\n2. –ò–ª–∏ –∏—Å–ø—Ä–∞–≤—å—Ç–µ –≤—Ä—É—á–Ω—É—é: –ü–ö–ú –Ω–∞ –Ω–∏–∫ ‚Üí \"–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫–Ω–µ–π–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ\"\",\n                    inline=False\n                )\n\n                view = NicknameRecheckView(user.id, suggested_nick)\n                await safe_send_message(channel, embed=nickname_embed, view=view)\n\n                logger.error(f\"üö´ –ñ–ï–°–¢–ö–ò–ô –û–¢–ö–ê–ó: –ù–∏–∫–Ω–µ–π–º '{current_nick}' —Å–æ–¥–µ—Ä–∂–∏—Ç {len(parts)-1} —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π, –æ–∂–∏–¥–∞–ª—Å—è –°–¢–†–û–ì–û 1. –ò–ò –ù–ï –í–´–ó–´–í–ê–ï–¢–°–Ø.\")\n                return  # –ò–ò –ù–ï –í–´–ó–´–í–ê–ï–¢–°–Ø –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è—Ö\n\n            # –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø AI –ø—Ä–æ–≤–µ—Ä–∫–∞ - –í–°–ï–ì–î–ê –≤—ã–∑—ã–≤–∞–µ–º LLM\n            logger.info(f\"ü§ñ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø AI –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏–∫–Ω–µ–π–º–∞: '{current_nick}'\")\n\n            try:\n                from utils.ai_moderation import decide_nickname\n                nick_result = await decide_nickname(current_nick)\n\n                logger.info(f\"ü§ñ AI —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è '{current_nick}': approve={nick_result.approve}\")\n                if nick_result.public_reasons:\n                    logger.info(f\"ü§ñ AI –ø—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è: {nick_result.public_reasons}\")\n\n                if not nick_result.approve:\n                    # –ù–∏–∫–Ω–µ–π–º –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞–º - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º\n                    public_reasons = nick_result.public_reasons or []\n                    fixed_suggestion = nick_result.fixed_full\n\n                    view = NicknameRecheckView(user.id, fixed_suggestion)\n                    nickname_embed = build_nick_reject_embed(\n                        user, current_nick, public_reasons, fixed_suggestion\n                    )\n\n                    await safe_send_message(\n                        channel,\n                        embed=nickname_embed,\n                        view=view\n                    )\n\n                    logger.info(f\"‚ö†Ô∏è –ù–∏–∫–Ω–µ–π–º –æ—Ç–∫–ª–æ–Ω–µ–Ω AI: {current_nick} - {', '.join(public_reasons)}\")\n                    return # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–ª—å–Ω–µ–π—à—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É\n                else:\n                    logger.info(f\"‚úÖ –ù–∏–∫–Ω–µ–π–º –æ–¥–æ–±—Ä–µ–Ω AI: {current_nick}\")\n\n            except Exception as e:\n                logger.error(f\"‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê AI –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∏–∫–Ω–µ–π–º–∞ '{current_nick}': {e}\")\n                # –ü—Ä–∏ –æ—à–∏–±–∫–µ AI –û–¢–ö–õ–û–ù–Ø–ï–ú –∑–∞—è–≤–∫—É\n                error_embed = discord.Embed(\n                    title=\"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∏–∫–Ω–µ–π–º–∞\",\n                    description=\"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ –Ω–∏–∫–Ω–µ–π–º–∞. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—É.\",\n                    color=0xFF0000\n                )\n                await safe_send_message(channel, embed=error_embed)\n                return\n\n            await safe_send_message(\n                channel,\n                f\"‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à—ë–Ω! –û–∂–∏–¥–∞–π—Ç–µ —Ä–µ—à–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞.\"\n            )\n\n            # –°–æ–∑–¥–∞–µ–º embed —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞ –∏ –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è\n            result_embed = discord.Embed(\n                title=\"‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞—è–≤–∫–∏ –∑–∞–≤–µ—Ä—à—ë–Ω\",\n                description=f\"–ó–∞—è–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user.display_name} –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—é\",\n                color=0x00FF00,\n                timestamp=datetime.now(timezone.utc),\n            )\n            result_embed.add_field(\n                name=\"üë§ –ó–∞—è–≤–∏—Ç–µ–ª—å\",\n                value=f\"{user.display_name}\\nID: `{user.id}`\",\n                inline=True\n            )\n            result_embed.add_field(\n                name=\"üìä –°—Ç–∞—Ç—É—Å\",\n                value=\"–û–∂–∏–¥–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞\",\n                inline=True\n            )\n            result_embed.set_footer(text=\"–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –ø—Ä–∏–Ω—è—Ç—å –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞—è–≤–∫—É\")\n\n            # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∏ —Å–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ —Ä–µ—à–µ–Ω–∏—è\n            # from handlers.novichok_actions import TicketActionView # –£–∂–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤—ã—à–µ\n            decision_view = TicketActionView(user.id, channel.id) # –ü–µ—Ä–µ–¥–∞–µ–º channel.id –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è\n\n            await safe_send_message(\n                channel,\n                embed=result_embed,\n                view=decision_view\n            )\n\n            logger.info(f\"‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞—è–≤–∫–∏ –∑–∞–≤–µ—Ä—à—ë–Ω –¥–ª—è {user.display_name}\")\n\n        except Exception as e:\n            logger.error(f\"‚ùå –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –∑–∞—è–≤–∫–∏: {e}\\n{traceback.format_exc()}\")\n            await safe_send_message(\n                channel,\n                f\"‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –∑–∞—è–≤–∫–∏. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—É.\"\n            )\n            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ —Å —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–æ–π\n            await log_error(e, traceback.format_exc())\n\n\nasync def setup(bot):\n    \"\"\"–ù–∞—Å—Ç—Ä–æ–π–∫–∞ cog –¥–ª—è tickets\"\"\"\n    # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º persistent views\n    bot.add_view(NicknameFixView(0, \"\", \"\", \"\"))\n    bot.add_view(NicknameRecheckView(0, None))\n    bot.add_view(NicknameMismatchFixView(0, \"\", \"\", \"\"))\n    logger.info(\"‚úÖ Persistent views –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ tickets.py\")\n\n    await bot.add_cog(TicketHandler(bot))"}
]